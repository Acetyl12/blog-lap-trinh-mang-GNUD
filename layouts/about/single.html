{{ define "main" }}
<article class="container mx-auto p-6">
  {{ $p := site.Data.profile }}

  <!-- Header 2 cột: Ảnh trái, nội dung phải -->
  <header class="mb-8 grid md:grid-cols-5 gap-6 items-center">
    <!-- ẢNH CHỮ NHẬT BÊN TRÁI (không crop, không bo tròn tròn) -->
    <div class="md:col-span-2">
      {{/* Lấy đường dẫn từ data/profile.yml; nếu trống → dùng mặc định */}}
      {{ $pick := (cond (and $p.hero (ne $p.hero "")) $p.hero $p.avatar) | default "images/avatar.png" }}

      {{/* Chuẩn hoá: bỏ dấu "/" đầu nếu có */}}
      {{ $path := strings.TrimPrefix "/" $pick }}

      {{/* Đường dẫn tuyệt đối tới file trong thư mục build để kiểm tra tồn tại + tạo version */}}
      {{ $abs := printf "static/%s" $path }}

      <img
        src='{{ if fileExists $abs }}{{ (printf "%s?v=%s" $path (md5 (readFile $abs))) | relURL }}{{ else }}{{ $path | relURL }}{{ end }}'
        alt='{{ $p.name }}'
        class="w-full h-56 md:h-64 object-cover object-top rounded-2xl shadow-md">
    </div>

    <!-- NỘI DUNG BÊN PHẢI -->
    <div class="md:col-span-3">
      <h1 class="text-3xl font-bold">{{ $p.name }}</h1>
      {{ with $p.headline }}<p class="opacity-80 mt-1">{{ . }}</p>{{ end }}
      {{ with $p.location }}<p class="text-sm opacity-70 mt-1">{{ . }}</p>{{ end }}
    </div>
  </header>

  {{ with $p.bio }}
  <section class="prose dark:prose-invert max-w-none">
    <p>{{ . }}</p>
  </section>
  {{ end }}

  {{ with $p.skills }}
  <section class="mt-6">
    <h2 class="text-xl font-semibold mb-2">Kỹ năng</h2>
    <div class="flex flex-wrap gap-2">
      {{ range . }}
        <span class="px-3 py-1 rounded-full bg-neutral-100 dark:bg-neutral-800 text-sm">{{ . }}</span>
      {{ end }}
    </div>
  </section>
  {{ end }}

  {{ with $p.links }}
  <section class="mt-6">
    <h2 class="text-xl font-semibold mb-2">Liên kết</h2>
    <ul class="flex flex-wrap gap-3">
      {{ range . }}
        <li>
          <a class="px-3 py-1 rounded-lg bg-neutral-100 dark:bg-neutral-800 hover:bg-neutral-200 dark:hover:bg-neutral-700"
             href="{{ .url }}" target="_blank" rel="noopener">{{ .label }}</a>
        </li>
      {{ end }}
    </ul>
  </section>
  {{ end }}

  {{ with $p.resume_url }}
  <section class="mt-6">
    <a class="inline-block px-4 py-2 rounded-lg bg-black text-white dark:bg-white dark:text-black"
       href="{{ . | relURL }}" target="_blank" rel="noopener">Tải CV</a>
  </section>
  {{ end }}

  <!-- Nội dung Markdown bổ sung trong content/about/index.md -->
  <section class="prose dark:prose-invert mt-8 max-w-none">
    {{ .Content }}
  </section>
</article>
{{ end }}
